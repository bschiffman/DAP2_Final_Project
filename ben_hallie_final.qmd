```{python}
#load in necessary packages
import pandas as pd
```

```{python}
#load in all the data
path = r"/Users/hallielovin/Documents/GitHub/DAP2_Final_Project/Data"

le = r"Life_Expectancy.csv"

le_df = pd.read_csv(os.path.join(path, le))

income = r"Median_Income.csv"

income_df = pd.read_csv(os.path.join(path, income))

safe_play = r"Safe_Play_Places.csv"

safe_play_df = pd.read_csv(os.path.join(path, safe_play))

crime = r"Serious_Violent_Crimes.csv"

crime_df = pd.read_csv(os.path.join(path, crime))
```

```{python}
common_col = ["OBJECTID", "Geography ID", "Geography Type", "Name"]

le_df.columns = [col if col in common_col else "le_" + col for col in le_df.columns]

income_df.columns = [col if col in common_col else "income_" + col for col in income_df.columns]

safe_play_df.columns = [col if col in common_col else "safe_play_" + col for col in safe_play_df.columns]

crime_df.columns = [col if col in common_col else "crime_" + col for col in crime_df.columns]
```

```{python}
#merge the df all together
df = pd.merge(crime_df, income_df, on = common_col, how = "outer")

df = pd.merge(le_df, df, on = common_col, how = "outer")

df = pd.merge(safe_play_df, df, on = common_col, how = "outer")
```

```{python}
#doing some renaming to make columns more easily accessible 
df.rename(columns={"safe_play_Percentage of Children (Ages 1 to 17 Years) With Easy Access to a Park, Playground, or Other Safe Place to Play": "perc_safe_play_places", "le_Life Expectancy at Birth ": "le_at_birth", "income_Median Household Income": "median_income","crime_Serious Violent Crimes (per 100,000 Population), 2022": "crime"}, inplace=True)
```

```{python}
#find the mean of the % of safe play places
safe_mean = df["perc_safe_play_places"].mean()
```

```{python}
#find the mean of le
le_mean = df["le_at_birth"].mean()
```

```{python}
#find the mean of income 
income_mean = df["median_income"].mean()
```

```{python}
#find the mean of crime 
crime_mean = df["crime"].mean()
```

```{python}
#import altair 
import altair as alt
```
